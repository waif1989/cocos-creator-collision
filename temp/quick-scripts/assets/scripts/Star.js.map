{"version":3,"sources":["Star.js"],"names":["cc","Class","extends","Component","properties","game","default","serializable","jumpAudio","url","AudioClip","pickRadius","getPlayerDistance","playerPos","player","getPosition","dist","pDistance","node","position","onPicked","gainScore","newRandomFunc","Min","Max","Range","Rand","Math","random","num","floor","onCollisionEnter","round","finished","callFunc","self","setTimeout","ground","gameOver","spawnNewStar","jumpAble","destroy","t","random0To1","r","actionAll","spawn","moveTo","p","rotateBy","runAction","easing","easeOut","console","log","start"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,UAASF,GAAGG,SADP;;AAGLC,aAAY;AACX;AACAC,QAAM;AACLC,YAAS,IADJ;AAELC,iBAAc;AAFT,GAFK;AAMX;AACAC,aAAW;AACVF,YAAS,IADC;AAEVG,QAAKT,GAAGU;AAFE,GAPA;AAWX;AACAC,cAAY;AAZD,EAHP;;AAkBRC,oBAAmB,6BAAY;AAC9B;AACA,MAAIC,YAAY,KAAKR,IAAL,CAAUS,MAAV,CAAiBC,WAAjB,EAAhB;AACA;AACA,MAAIC,OAAOhB,GAAGiB,SAAH,CAAa,KAAKC,IAAL,CAAUC,QAAvB,EAAiCN,SAAjC,CAAX;AACA,SAAOG,IAAP;AACA,EAxBO;;AA0BRI,WAAU,oBAAW;AACpB;AACA,OAAKf,IAAL,CAAUgB,SAAV;AACA,EA7BO;;AA+BRC,gBAAe,uBAAUC,GAAV,EAAeC,GAAf,EAAoB;AAClC,MAAIC,QAAQD,MAAMD,GAAlB;AACA,MAAIG,OAAOC,KAAKC,MAAL,EAAX;AACA,MAAIC,MAAMN,MAAMI,KAAKG,KAAL,CAAWJ,OAAOD,KAAlB,CAAhB,CAHkC,CAGQ;AAC1C,SAAOI,GAAP;AACA,EApCO;;AAsCRE,mBAAkB,4BAAY;AAC1B,MAAI,KAAK1B,IAAL,CAAU2B,KAAd,EAAqB;AACpB,QAAK3B,IAAL,CAAU2B,KAAV,GAAkB,KAAlB;AACA,OAAIC,WAAWjC,GAAGkC,QAAH,CAAY,YAAW;AACrC,QAAIC,OAAO,IAAX;AACAC,eAAW,YAAY;AACtB;AACA,SAAI,CAACD,KAAK9B,IAAL,CAAUgC,MAAV,CAAiBC,QAAtB,EAAgC;AAC/BH,WAAK9B,IAAL,CAAUkC,YAAV;AACAJ,WAAK9B,IAAL,CAAUS,MAAV,CAAiB0B,QAAjB,GAA4B,IAA5B;AACAL,WAAK9B,IAAL,CAAU2B,KAAV,GAAkB,IAAlB;AACA;AACAG,WAAKjB,IAAL,CAAUuB,OAAV;AACA,MAND,MAMO;AACNN,WAAK9B,IAAL,CAAUS,MAAV,CAAiB0B,QAAjB,GAA4B,KAA5B;AACAL,WAAKjB,IAAL,CAAUuB,OAAV;AACA;AACD,KAZD,EAYG,GAZH;AAaA,IAfc,EAeZ,IAfY,CAAf;AAgBA,OAAIC,IAAI1C,GAAG2C,UAAH,KAAkB,GAAlB,GAAwB,CAAC,CAAzB,GAA6B,CAArC;AACA,OAAIC,IAAI,KAAKtB,aAAL,CAAmB,CAAnB,EAAsB,CAAtB,CAAR;AACA,OAAIuB,YAAY7C,GAAG8C,KAAH,CACf9C,GAAG+C,MAAH,CAAU,KAAKzB,aAAL,CAAmB,GAAnB,EAAwB,GAAxB,CAAV,EAAwCtB,GAAGgD,CAAH,CAAKN,IAAI,GAAJ,GAAUE,CAAf,EAAkB,MAAMA,CAAxB,CAAxC,CADe,EAEf5C,GAAGiD,QAAH,CAAY,CAAZ,EAAe,GAAf,CAFe,EAGfhB,QAHe,CAAhB;AAKA,QAAKf,IAAL,CAAUgC,SAAV,CAAoBL,UAAUM,MAAV,CAAiBnD,GAAGoD,OAAH,CAAW,GAAX,CAAjB,CAApB;AACA,QAAKhC,QAAL;AACA;AACJiC,UAAQC,GAAR,CAAY,gBAAZ;AACA,EApEO;;AAsER;;;;;;;;;AASG;;AAEA;;AAEAC,MAnFK,mBAmFI,CAER;AArFI;;AAuFL;AAvFJ","file":"Star.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\t    // 暂存 Game 对象的引用\r\n\t    game: {\r\n\t\t    default: null,\r\n\t\t    serializable: false\r\n\t    },\r\n\t    // 跳跃音效资源\r\n\t    jumpAudio: {\r\n\t\t    default: null,\r\n\t\t    url: cc.AudioClip\r\n\t    },\r\n\t    // 星星和主角之间的距离小于这个数值时，就会完成收集\r\n\t    pickRadius: 0\r\n    },\r\n\t\r\n\tgetPlayerDistance: function () {\r\n\t\t// 根据 player 节点位置判断距离\r\n\t\tvar playerPos = this.game.player.getPosition();\r\n\t\t// 根据两点位置计算两点之间距离\r\n\t\tvar dist = cc.pDistance(this.node.position, playerPos);\r\n\t\treturn dist;\r\n\t},\r\n\t\r\n\tonPicked: function() {\r\n\t\t// 调用 Game 脚本的得分方法\r\n\t\tthis.game.gainScore();\r\n\t},\r\n\t\r\n\tnewRandomFunc: function (Min, Max) {\r\n\t\tvar Range = Max - Min;\r\n\t\tvar Rand = Math.random();\r\n\t\tvar num = Min + Math.floor(Rand * Range); // 舍去\r\n\t\treturn num;\r\n\t},\r\n\t\r\n\tonCollisionEnter: function () {\r\n    \tif (this.game.round) {\r\n\t\t    this.game.round = false;\r\n\t\t    var finished = cc.callFunc(function() {\r\n\t\t    \tvar self = this;\r\n\t\t    \tsetTimeout(function () {\r\n\t\t\t\t    // 当星星被收集时，调用 Game 脚本中的接口，生成一个新的星星\r\n\t\t\t\t    if (!self.game.ground.gameOver) {\r\n\t\t\t\t\t    self.game.spawnNewStar();\r\n\t\t\t\t\t    self.game.player.jumpAble = true;\r\n\t\t\t\t\t    self.game.round = true;\r\n\t\t\t\t\t    // 然后销毁当前星星节点\r\n\t\t\t\t\t    self.node.destroy();\r\n\t\t\t\t    } else {\r\n\t\t\t\t\t    self.game.player.jumpAble = false;\r\n\t\t\t\t\t    self.node.destroy();\r\n\t\t\t\t    }\r\n\t\t\t    }, 700);\r\n\t\t    }, this);\r\n\t\t    var t = cc.random0To1() > 0.5 ? -1 : 1;\r\n\t\t    var r = this.newRandomFunc(1, 2);\r\n\t\t    var actionAll = cc.spawn(\r\n\t\t\t    cc.moveTo(this.newRandomFunc(1.8, 2.1), cc.p(t * 750 * r, 750 * r)),\r\n\t\t\t    cc.rotateBy(2, 720),\r\n\t\t\t    finished\r\n\t\t    );\r\n\t\t    this.node.runAction(actionAll.easing(cc.easeOut(3.0)));\r\n\t\t    this.onPicked();\r\n\t    }\r\n\t\tconsole.log('Star collision')\r\n\t},\r\n\t\r\n\t/*update: function (dt) {\r\n\t\t// 每帧判断和主角之间的距离是否小于收集距离\r\n\t\tif (this.getPlayerDistance() < this.pickRadius) {\r\n\t\t\t// 调用收集行为\r\n\t\t\tthis.onPicked();\r\n\t\t\treturn;\r\n\t\t}\r\n\t},*/\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}